import{_ as n,c as a,o as s,a as t}from"./app.d283e5b5.js";const h='{"title":"Watch","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u5F00\u59CB","slug":"\u5F00\u59CB"},{"level":2,"title":"\u6E90\u7801","slug":"\u6E90\u7801"}],"relativePath":"Vue/Watch/index.md","lastUpdated":1640256211252}',p={},o=t(`<h1 id="watch" tabindex="-1">Watch <a class="header-anchor" href="#watch" aria-hidden="true">#</a></h1><p>vue-next</p><h2 id="\u5F00\u59CB" tabindex="-1">\u5F00\u59CB <a class="header-anchor" href="#\u5F00\u59CB" aria-hidden="true">#</a></h2><ul><li>watch</li><li>watchEffect</li><li>watchPostEffect</li><li>watchSyncEffect</li></ul><p>\u8FD9\u56DB\u4E2A\u51FD\u6570\u90FD\u662F\u4F7F\u7528\u7684 <code>doWatch</code> \u51FD\u6570</p><p><code>dowatch</code> \u7684\u51FD\u6570\u539F\u7406\u53C8\u7C7B\u4F3C\u4E8E <code>effect</code></p><h2 id="\u6E90\u7801" tabindex="-1">\u6E90\u7801 <a class="header-anchor" href="#\u6E90\u7801" aria-hidden="true">#</a></h2><blockquote><p>packages\\runtime-core\\src\\apiWatch.ts</p></blockquote><div class="language-typescript"><pre><code><span class="token keyword">const</span> effect <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReactiveEffect</span><span class="token punctuation">(</span>getter<span class="token punctuation">,</span> scheduler<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// TODO:</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>__DEV__<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  effect<span class="token punctuation">.</span>onTrack <span class="token operator">=</span> onTrack<span class="token punctuation">;</span>
  effect<span class="token punctuation">.</span>onTrigger <span class="token operator">=</span> onTrigger<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// initial run</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>immediate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">job</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    oldValue <span class="token operator">=</span> effect<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>flush <span class="token operator">===</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">queuePostRenderEffect</span><span class="token punctuation">(</span>effect<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>effect<span class="token punctuation">)</span><span class="token punctuation">,</span> instance <span class="token operator">&amp;&amp;</span> instance<span class="token punctuation">.</span>suspense<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  effect<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  effect<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">&amp;&amp;</span> instance<span class="token punctuation">.</span>scope<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">remove</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>scope<span class="token punctuation">.</span>effects<span class="token operator">!</span><span class="token punctuation">,</span> effect<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>`,9),c=[o];function e(u,l,i,k,r,d){return s(),a("div",null,c)}var _=n(p,[["render",e]]);export{h as __pageData,_ as default};
